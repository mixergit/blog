## OLLAMA 环境变量/高级参数配置 : 监听 , 内存释放窗口 , 常用设置举例         
                                                                              
### 作者                                                  
digoal                                                  
                                                         
### 日期                                                       
2024-08-06                                                  
                                                      
### 标签                                                    
PostgreSQL , PolarDB , DuckDB , LLM , ollama , 参数 , 监听 , 内存释放窗口配置                          
                                                                             
----                                                      
                                                                    
## 背景          
大家都在干, 是不是已经很卷了, 现在进去是不是太晚了?        
      
你身边的同行都还没开始干, 是不是没什么钱景?  这不是机会什么时候是机会, 掌握先发优势啊.        
      
好像AI就是这样.       
      
以上From: 圈外同学和鹤老师说经济.       
      
## OLLAMA 环境变量/高级参数配置       
1、如何把Mac变成提供LLM API服务的服务器?       
      
首先要让ollama监听`0.0.0.0`地址, 这样远程服务才能访问其API. 如果想开放公网, 搞个跳转或者域名.       
      
不过这样比较危险, 也没有个认证服务. 配合webui就比较安全了, 支持认证. 参考:      
   
https://github.com/open-webui/open-webui    
   
https://blog.csdn.net/qq_53795212/article/details/139690567    
      
以mac为例配置环境变量      
```      
launchctl setenv OLLAMA_HOST "0.0.0.0"      
```      
      
重启ollama服务即可      
```      
sudo lsof -nP|grep 11434        
ollama    3388                digoal    3u     IPv6 0xd735b73c12503cc7        0t0                 TCP *:11434 (LISTEN)      
ollama    3388                digoal    9u     IPv6 0xd735b73c12504447        0t0                 TCP 127.0.0.1:11434->127.0.0.1:51106 (ESTABLISHED)      
ollama    3451                digoal    6u     IPv4 0xd735b745a8c9940f        0t0                 TCP 127.0.0.1:51106->127.0.0.1:11434 (ESTABLISHED)      
```      
      
2、如何让模型常驻内存, 提升访问效率.         
      
以mac为例配置环境变量      
```      
launchctl setenv OLLAMA_KEEP_ALIVE "-1"      
```      
      
UNTIL显示还有多久清出内存      
```      
ollama ps       
NAME     	ID          	SIZE  	PROCESSOR	UNTIL         
gemma2:9b	ff02c3702f32	9.5 GB	100% GPU 	Forever	      
```      
      
反之也可以设置为0, 立即清除出内存.         
      
      
3、除了使用环境变量设置参数, 调用api时也可以覆盖设置好的参数      
```      
curl http://localhost:11434/api/generate -d '{"model": "gemma2:9b", "keep_alive": 60}'      
      
ollama ps      
NAME     	ID          	SIZE  	PROCESSOR	UNTIL                     
gemma2:9b	ff02c3702f32	9.5 GB	100% GPU 	55 seconds from now      
```      
      
```      
curl http://localhost:11434/api/generate -d '{"model": "gemma2:9b", "keep_alive": -1}'      
      
ollama ps      
NAME     	ID          	SIZE  	PROCESSOR	UNTIL         
gemma2:9b	ff02c3702f32	9.5 GB	100% GPU 	Forever      
```      
      
4、更多环境变量如下      
      
```      
OLLAMA_HOST      
OLLAMA_KEEP_ALIVE      
OLLAMA_MODELS      
OLLAMA_ORIGINS      
OLLAMA_MAX_QUEUE      
OLLAMA_MAX_LOADED_MODELS      
OLLAMA_NUM_PARALLEL      
```      
    
## 常用参数设置    
[《AI大模型+全文检索+tf-idf+向量数据库+我的文章 系列之8 - 大模型(LLM)常见参数设置, 影响性能和可靠性》](../202407/20240731_02.md)      
    
最大上下文tokens数, 温度, 最大生成tokens数, 聚焦.      
```    
/set parameter num_ctx 8192    
```
  
```
/set parameter temperature 0    
```
  
```
/set parameter num_predict -1    
```
  
```
/set parameter mirostat_tau 1.0    
```    
    
    
### 例子1: 高度发达的国家的行业划分方法    
高度发达国家的行业划分方法主要基于以下几个原则：    
    
**1.  经济活动分类:**     
    
* **第一产业 (Primary Sector):** 以自然资源开采和加工为主，如农业、林业、渔业、矿业等。在高度发达国家，这一产业通常规模较小，因为自动化和全球化导致生产效率提高。    
* **第二产业 (Secondary Sector):** 以工业生产为主，包括制造业、建筑业、能源生产等。高度发达国家的第二产业通常具有高技术含量和精细化程度，例如汽车制造、电子产品生产等。    
* **第三产业 (Tertiary Sector):** 以服务业为主，例如零售、餐饮、金融、教育、医疗、旅游等。在高度发达国家，第三产业通常是最大的经济部门，并且不断创新发展新的服务模式。    
    
**2.  产品和服务的细分:** 为了更准确地反映经济结构的复杂性，高度发达国家的行业划分还会根据产品的类型或服务的性质进行细分。常见的分类方法包括：    
    
* **NAICS (北美工业分类体系):** 由美国、加拿大和墨西哥共同制定，涵盖了从农业到信息技术的所有行业。    
* **NACE (欧洲经济活动分类体系):** 由欧盟成员国使用，与 NAICS 相似。    
* **ISO (国际标准化组织) 行业分类:** 旨在为全球贸易和数据分析提供统一的行业分类标准。    
    
**3.  价值链分析:**  一些高度发达国家会根据产品的生产和销售过程中的不同环节进行划分，例如研发、生产、营销、售后服务等，以更清晰地反映企业的核心竞争力。    
    
**4.  新兴行业的融合:** 随着科技发展和经济转型，高度发达国家的行业划分也越来越关注新兴产业的融合与发展，例如数字经济、生物技术、人工智能等，并将它们纳入现有的分类体系中。    
    
    
希望以上信息能帮助你理解高度发达国家的行业划分方法！    
    
### 例子2: NAICS (北美工业分类体系)划分了哪些行业, 请按经济活动归类  
好的，以下是 NAICS (北美工业分类体系) 按经济活动归类的行业划分：  
  
**1.  第一产业 (Primary Sector):**   
  
* **农业、林业和渔业:** 包括农作物种植、畜牧养殖、森林管理、捕捞等。  
    * 例如： NAICS 代码 111 - 蔬菜和水果种植，NAICS 代码 112 - 肉类动物饲养，NAICS 代码 114 - 鱼类捕捞  
  
**2.  第二产业 (Secondary Sector):**  
  
* **制造业:** 包括加工原材料、组装产品、生产设备等。  
    * 例如： NAICS 代码 311 - 食品制造，NAICS 代码 336 - 汽车制造，NAICS 代码 353 - 电气设备制造  
* **建筑业:** 包括房屋建造、道路修建、桥梁施工等。  
    * 例如： NAICS 代码 236 - 建筑工程承包  
  
**3.  第三产业 (Tertiary Sector):**  
  
* **批发和零售贸易:** 包括批发商品、零售商品等。  
    * 例如： NAICS 代码 423 - 电子产品批发，NAICS 代码 445 - 服装零售  
* **交通运输和仓储:** 包括公路运输、铁路运输、航空运输、物流等。  
    * 例如： NAICS 代码 481 - 航空运输，NAICS 代码 493 - 物流服务  
* **金融和保险业:** 包括银行、证券公司、保险公司等。  
    * 例如： NAICS 代码 522 - 商业银行，NAICS 代码 524 - 保险经纪人  
* **医疗保健和社会保障:** 包括医院、诊所、养老院等。  
    * 例如： NAICS 代码 621 - 医院，NAICS 代码 624 - 护理服务  
* **教育和研究:** 包括学校、大学、科研机构等。  
    * 例如： NAICS 代码 611 - 大学，NAICS 代码 613 - 专业培训学校  
* **艺术、娱乐和休闲:** 包括电影院、剧院、游乐场等。  
    * 例如： NAICS 代码 711 - 电影院，NAICS 代码 712 - 剧院  
  
**4.  其他服务业:** 包括政府、私人家庭服务等。  
  
  
请注意，这只是一个简要概述，NAICS 系统包含数百个细分行业类别。  
  
  
  
  
  
### 例子3: 科研、高科技行业呢?  
你问到一个很好的点！ NAICS 虽然提供了广泛的分类，但它本身并不专门针对“科研”和“高科技行业”。    
  
为了更好地理解这些领域，我们可以结合 NAICS 的分类以及其他指标：  
  
**1.  NAICS 中相关的类别:**  
  
* **研发活动 (R&D):**    
    * 许多公司将研发部门纳入其现有业务的框架中，例如制造业、信息技术等。 NAICS 会根据公司的主要产品或服务进行分类。  
    * 例如：一家从事汽车制造的公司，其研发部门可能归类于 NAICS 代码 336 (汽车制造)。  
* **科学研究和技术服务:**  NAICS 代码 5417 包括提供科学研究、技术咨询等服务的公司。  
  
**2.  其他指标:**  
  
* **行业协会:** 高科技行业通常由专门的行业协会组织，例如：  
    * 美国计算机与通信产业协会 (CompTIA)  
    * 生物技术创新组织 (BIO)  
    * 电子工业协会 (EIA)  
* **政府政策和资金:** 许多国家会通过政策和资金支持科研和高科技发展，这些政策可以帮助识别相关行业。  
  
**3.  新兴领域:**  
  
* **数字经济、人工智能、生物技术等新兴领域:** NAICS 系统也在不断更新，以适应快速变化的经济环境。  
  
  
总而言之，虽然 NAICS 无法直接划分“科研”和“高科技行业”，但我们可以通过结合 NAICS 分类、行业协会、政府政策以及其他指标来更好地理解这些领域的特征和发展趋势。  
  
### 例子4: 要了解各个行业的生产资料、生产工具和消费者关系, 行业中的每类企业的使命和竞争力, 企业中的每类应用的业务目标和特点, 每类应用对数据库的关键需求.   
你提出的问题非常深入，涉及到行业分析、企业战略以及数据库设计等多个方面。为了更好地回答你的问题，我需要更具体的行业或领域作为参考。  
  
**举例来说，如果你想了解：**  
  
* **汽车制造业:** 我可以告诉你不同类型的汽车制造商（例如传统车企、电动车公司、共享出行平台）的生产资料、生产工具、消费者关系、使命和竞争力等信息。  
* **金融科技行业:** 我可以分析不同类型的金融科技公司（例如支付平台、贷款平台、投资理财平台）的业务目标、应用特点以及对数据库的关键需求。  
  
**为了更精准地回答你的问题，请告诉我你想了解哪一个行业的具体情况？**  
  
  
以下是一些我能够提供的信息：  
  
* **生产资料和工具:**  我会列举该行业常用的原材料、设备、技术等。  
* **消费者关系:** 我会分析目标客户群体、消费行为模式、市场竞争格局等。  
* **企业使命和竞争力:** 我会总结不同类型的企业在该行业的定位、核心价值观以及竞争优势。  
* **业务目标和特点:** 我会描述不同类型企业的业务模式、产品服务特点以及发展趋势。  
* **数据库关键需求:** 我会分析该行业企业对数据存储、处理、分析等方面的需求，并给出相应的数据库设计建议。  
  
  
  
请告诉我你想了解哪个行业的具体情况，我会尽力为你提供详细的答案！  
  
### 例子5: 新能源汽车行业  
好的，你想要了解新能源汽车行业的各个方面，这是一个非常热门且快速发展的领域！  
  
**1. 生产资料和工具:**  
  
* **原材料:** 电池材料（锂、钴、镍等）、电池芯、电机、电子控制系统、轻质材料（铝合金、碳纤维等）。  
* **生产工具:** 自动化装配线、机器人焊接、3D打印技术、智能检测设备。  
  
**2. 消费者关系:**  
  
* **目标客户群体:**  环保意识强、追求科技感、注重驾驶体验的消费者，包括个人用户、企业用户（如出租车公司）。  
* **消费行为模式:** 线上线下结合购车方式、关注续航里程、充电设施、智能化功能等。  
* **市场竞争格局:** 众多传统汽车制造商和新兴电动汽车公司激烈竞争，例如特斯拉、比亚迪、蔚来、小鹏等。  
  
**3. 企业使命和竞争力:**  
  
* **传统车企:**  转型升级，利用现有资源和渠道进入新能源汽车市场，提升品牌形象和市场份额。  
* **新兴电动汽车公司:**  专注于技术创新，打造差异化产品，抢占市场先机，例如特斯拉的智能驾驶系统、比亚迪的电池技术优势。  
  
**4. 业务目标和特点:**  
  
* **销售目标:** 扩大销量，提升市场份额，实现盈利增长。  
* **产品策略:**  开发不同续航里程、价格定位、功能配置的新能源汽车车型，满足多样化需求。  
* **服务模式:** 提供完善的充电网络、售后服务体系，提升用户体验。  
  
**5. 数据库关键需求:**  
  
* **数据存储:** 能够存储海量车辆运行数据、用户行为数据、电池性能数据等。  
* **数据分析:**  支持对车辆行驶轨迹、驾驶习惯、电池使用情况等数据的分析，为产品改进和服务优化提供依据。  
* **实时处理:**  支持实时监控车辆状态、充电进度、故障信息等，保障车辆安全性和用户体验。  
* **数据安全:**  确保用户隐私数据安全，防止数据泄露和恶意攻击。  
  
  
  
希望以上信息能帮助你了解新能源汽车行业的各个方面！  
  
  
## 参考      
https://github.com/ollama/ollama/blob/main/docs/faq.md       
      
https://github.com/ollama/ollama/blob/main/docs/api.md       
      
https://github.com/ollama/ollama/blob/main/docs/modelfile.md       
      
      
  
#### [期望 PostgreSQL|开源PolarDB 增加什么功能?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB 开源数据库](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB 学习图谱](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [购买PolarDB云服务折扣活动进行中, 55元起](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
  
  
#### [PostgreSQL 解决方案集合](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥 / digoal's Github - 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About 德哥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
